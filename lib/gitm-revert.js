#!/usr/bin/env node
"use strict";require("core-js/modules/es.symbol.js");require("core-js/modules/es.symbol.description.js");require("core-js/modules/es.function.name.js");require("core-js/modules/web.dom-collections.for-each.js");require("core-js/modules/es.regexp.flags.js");require("core-js/modules/es.number.constructor.js");require("core-js/modules/es.array.concat.js");var program=require("commander");var sh=require("shelljs");var _require=require("./conf/revert"),options=_require.options,args=_require.args;var _require2=require("./js/index"),warning=_require2.warning,queue=_require2.queue,createArgs=_require2.createArgs;program.name("gitm revert").usage("[commitid] [-n --number [number]] [-m --mode [mode]]").description("撤销一次提交记录");if(args.length>0)program.arguments(createArgs(args));options.forEach(function(o){program.option(o.flags,o.description,o.defaultValue)});program.action(function(commitid,opt){var cmd=[],n="HEAD",m="";if(opt.mode)m=" -m "+Math.abs(Number(opt.mode));if(opt.number){var num=Math.abs(Number(opt.number));if(num>1)n+="~"+(num-1);cmd.push({cmd:"git revert ".concat(n).concat(m),config:{slient:false,again:true,success:"撤销成功",fail:"出错了，请根据提示处理"}})}else if(commitid){cmd.push({cmd:"git revert ".concat(commitid).concat(m),config:{slient:false,again:true,success:"撤销成功",fail:"出错了，请根据提示处理"}})}else{sh.echo(warning("指令不合法"));sh.exit(1)}queue(cmd)});program.parse(process.argv);