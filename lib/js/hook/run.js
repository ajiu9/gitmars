"use strict";require("core-js/modules/es.array.concat.js");require("core-js/modules/es.array.includes.js");require("core-js/modules/es.array.join.js");require("core-js/modules/es.array.slice.js");require("core-js/modules/es.object.assign.js");require("regenerator-runtime/runtime.js");function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _toArray(arr){return _arrayWithHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var fs=require("fs");var path=require("path");var _require=require("child_process"),spawnSync=_require.spawnSync;var readPkg=require("../readPkg");var getHookComment=require("./getHookComment");var config=require("./getConfig")();function getCommand(cwd,hookName){return config&&config.hooks&&config.hooks[hookName]}function runCommand(cwd,hookName,cmd,env){console.log("gitmars > ".concat(hookName," (node ").concat(process.version,")"));var _spawnSync=spawnSync("sh",["-c",cmd],{cwd:cwd,env:Object.assign(Object.assign({},process.env),env),stdio:"inherit"}),status=_spawnSync.status;if(status!==0){var noVerifyMessage=["commit-msg","pre-commit","pre-rebase","pre-push"].includes(hookName)?"(add --no-verify to bypass)":"(cannot be bypassed with --no-verify due to Git specs)";console.log("gitmars > ".concat(hookName," hook failed ").concat(noVerifyMessage))}if(status===127){return 1}return status||0}function run1(_ref){var _ref2=_toArray(_ref),_ref2$=_ref2[2],hookName=_ref2$===void 0?"":_ref2$,GITMARS_GIT_PARAMS=_ref2.slice(3);var _ref3=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref3$cwd=_ref3.cwd,cwd=_ref3$cwd===void 0?process.cwd():_ref3$cwd;var command=getCommand(cwd,hookName);var env={};if(GITMARS_GIT_PARAMS===null||GITMARS_GIT_PARAMS===void 0?void 0:GITMARS_GIT_PARAMS.length){env.GITMARS_GIT_PARAMS=GITMARS_GIT_PARAMS.join(" ")}if(command){return runCommand(cwd,hookName,command,env)}return 0}module.exports=function(){var _run=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var status;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:checkGitDirEnv_1.checkGitDirEnv();_context.prev=1;_context.next=4;return _1.default(process.argv);case 4:status=_context.sent;process.exit(status);_context.next=12;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);console.log("Husky > unexpected error",_context.t0);process.exit(1);case 12:case"end":return _context.stop()}}},_callee,null,[[1,8]])}));function run(){return _run.apply(this,arguments)}return run}();