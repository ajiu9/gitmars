"use strict";function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}var inquirer=require("inquirer");var createPrompt=require("./createPrompt");var getCommand=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee(_ref){var command,args,options,validatorOpts,validatorArgs,transformOpts,transformArgs,params,needInput,needStep1,answer1,selection,answer2,answer3,arr;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:command=_ref.command,args=_ref.args,options=_ref.options,validatorOpts=_ref.validatorOpts,validatorArgs=_ref.validatorArgs,transformOpts=_ref.transformOpts,transformArgs=_ref.transformArgs;params=[],needInput=[];if(!(options.length>0)){_context.next=13;break}needStep1=options.some(function(option){return!option.optional&&!option.required||!option.recommend});if(!needStep1){_context.next=12;break}_context.next=7;return inquirer.prompt(createPrompt(command,{options:options,validator:validatorOpts,transform:transformOpts},"checkbox"));case 7:answer1=_context.sent;selection=answer1[command];selection.forEach(function(prop){var option=options.find(function(opt){return opt.long===prop});if(option.optional||option.required){needInput.push({required:option.required,name:option.long,variadic:false,defaultValue:option.defaultValue,description:option.description})}else{params.push(prop)}});_context.next=13;break;case 12:needInput=options.map(function(option){return{required:option.required,name:option.long,variadic:false,defaultValue:option.defaultValue,description:option.description}});case 13:if(!(args.length>0)){_context.next=18;break}_context.next=16;return inquirer.prompt(createPrompt(command,{options:args,validator:validatorArgs,transform:transformArgs},"input"));case 16:answer2=_context.sent;params=[].concat(Object.values(answer2)).concat(params);case 18:if(!(needInput.length>0)){_context.next=24;break}_context.next=21;return inquirer.prompt(createPrompt(command,{options:needInput},"input"));case 21:answer3=_context.sent;arr=Object.entries(answer3).map(function(item){if(item[1]!=="")item[1]='"'+item[1]+'"';return item});params=params.concat(arr.flat(Infinity));case 24:return _context.abrupt("return",Promise.resolve("".concat(params.join(" ").replace(/\s+/g," ").trim())));case 25:case"end":return _context.stop()}}},_callee)}));return function getCommand(_x){return _ref2.apply(this,arguments)}}();module.exports=getCommand;